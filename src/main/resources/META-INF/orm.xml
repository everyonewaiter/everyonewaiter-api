<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings
  xmlns="http://www.hibernate.org/xsd/orm/mapping"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.hibernate.org/xsd/orm/mapping https://hibernate.org/xsd/orm/mapping/mapping-3.1.0.xsd"
>

  <access>FIELD</access>

  <entity class="com.everyonewaiter.domain.health.ApkVersion">
    <table name="apk_version"/>

    <attributes>
      <basic name="majorVersion">
        <column name="apk_major_version" nullable="false"/>
      </basic>
      <basic name="minorVersion">
        <column name="apk_minor_version" nullable="false"/>
      </basic>
      <basic name="patchVersion">
        <column name="apk_patch_version" nullable="false"/>
      </basic>
      <basic name="downloadUri">
        <column name="apk_download_uri" nullable="false" length="255"/>
      </basic>
    </attributes>
  </entity>

  <entity class="com.everyonewaiter.domain.contact.Contact">
    <table name="contact">
      <index
        name="idx_contact_store_name_license_phone_number"
        column-list="store_name, license, phone_number"
      />
      <index name="idx_contact_store_name_phone_number" column-list="store_name, phone_number"/>
      <index name="idx_contact_license_phone_number" column-list="license, phone_number"/>
      <index name="idx_contact_phone_number" column-list="phone_number"/>
    </table>

    <attributes>
      <basic name="storeName">
        <column name="store_name" nullable="false" length="30"/>
      </basic>
      <basic name="state">
        <column name="state" nullable="false"/>
        <enumerated>STRING</enumerated>
      </basic>
      <embedded name="license"/>
      <embedded name="phoneNumber"/>
    </attributes>
  </entity>

  <entity class="com.everyonewaiter.domain.auth.RefreshToken">
    <table name="refresh_token"/>

    <attributes>
      <basic name="accountId">
        <column name="account_id" nullable="false" updatable="false"/>
      </basic>
      <basic name="currentTokenId">
        <column name="current_token_id" nullable="false"/>
      </basic>
    </attributes>
  </entity>

  <entity class="com.everyonewaiter.domain.account.Account">
    <table name="account">
      <index name="idx_account_phone_number" column-list="phone_number"/>
      <index name="idx_account_email_permission_state" column-list="email, permission, state"/>
      <index name="idx_account_email_state" column-list="email, state"/>
      <index name="idx_account_permission_state" column-list="permission, state"/>
      <index name="idx_account_state" column-list="state"/>
    </table>

    <attributes>
      <basic name="password">
        <column name="password" nullable="false" length="60"/>
      </basic>
      <basic name="state">
        <column name="state" nullable="false"/>
        <enumerated>STRING</enumerated>
      </basic>
      <basic name="permission">
        <column name="permission" nullable="false"/>
        <enumerated>STRING</enumerated>
      </basic>
      <basic name="lastSignIn">
        <column name="last_sign_in" nullable="false"/>
      </basic>
      <embedded name="email"/>
      <embedded name="phoneNumber"/>
    </attributes>
  </entity>

  <entity class="com.everyonewaiter.domain.device.Device">
    <table name="device">
      <unique-constraint name="uk_device_store_id_name">
        <column-name>store_id</column-name>
        <column-name>name</column-name>
      </unique-constraint>
      <index name="idx_device_store_id_purpose_state" column-list="store_id, purpose, state"/>
    </table>

    <attributes>
      <basic name="name">
        <column name="name" nullable="false" length="20"/>
      </basic>
      <basic name="purpose">
        <column name="purpose" nullable="false"/>
        <enumerated>STRING</enumerated>
      </basic>
      <basic name="tableNo">
        <column name="table_no" nullable="false"/>
      </basic>
      <basic name="state">
        <column name="state" nullable="false"/>
        <enumerated>STRING</enumerated>
      </basic>
      <basic name="paymentType">
        <column name="payment_type" nullable="false"/>
        <enumerated>STRING</enumerated>
      </basic>
      <basic name="secretKey">
        <column name="secret_key" nullable="false" length="30"/>
      </basic>
      <many-to-one name="store" fetch="LAZY" optional="false">
        <join-column name="store_id" nullable="false"/>
        <foreign-key constraint-mode="NO_CONSTRAINT"/>
      </many-to-one>
    </attributes>
  </entity>

  <embeddable class="com.everyonewaiter.domain.shared.Email">
    <attributes>
      <basic name="address">
        <column name="email" nullable="false" length="150"/>
      </basic>
    </attributes>
  </embeddable>

  <embeddable class="com.everyonewaiter.domain.shared.BusinessLicense">
    <attributes>
      <basic name="value">
        <column name="license" nullable="false" length="12"/>
      </basic>
    </attributes>
  </embeddable>

  <embeddable class="com.everyonewaiter.domain.shared.PhoneNumber">
    <attributes>
      <basic name="value">
        <column name="phone_number" nullable="false" length="11"/>
      </basic>
    </attributes>
  </embeddable>

  <embeddable class="com.everyonewaiter.domain.shared.Position">
    <attributes>
      <basic name="value">
        <column name="position" nullable="false"/>
      </basic>
    </attributes>
  </embeddable>

</entity-mappings>
