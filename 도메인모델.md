# 모두의 웨이터 도메인 모델

## 목차

- [공용](#공용)
- [헬스 체크](#헬스-체크)
- [서비스 도입 문의](#서비스-도입-문의)
- [알림](#알림)
- [SSE](#SSE)
- [인증](#인증)
- [계정](#계정)
- [기기](#기기)
- [매장 공통](#매장-공통)
- [매장 등록](#매장-등록)
- [매장](#매장)
- [매장 설정](#매장-설정)
- [메뉴](#메뉴)
- [웨이팅](#웨이팅)
- [주문](#주문)
- [주문 결제](#주문-결제)
- [직원 호출](#직원-호출)
- [레시피](#레시피)
- [POS](#POS)

---

## 공용

### BusinessException

_Exception_

#### 속성

- `errorCode`: 커스텀 에러 코드

### AuthenticationException

_BusinessException_

### AccessDeniedException

_BusinessException_

### 에러 코드

_Enum_

#### 상수

[ErrorCode.java](./src/main/java/com/everyonewaiter/domain/shared/ErrorCode.java)

#### 속성

- `status`: Http 상태 코드
- `message`: 클라이언트 전송용 메시지

### 페이지네이션(Pagination)

_Value Object_

#### 속성

- `page`: 페이지 번호
- `size`: 조회할 데이터 수
- `pageSkipSize`: FastForward 페이지 이동 사이즈 (default 5)

#### 행위

- `countLimit()`: FastForward 페이지 계산을 위해 `count` 조회해야하는 데이터 수를 반환한다.
- `limit()`: 조회할 데이터 수를 반환한다.
- `offset()`: `page`와 `size`를 가지고 스킵해야하는 `offset`을 계산하여 반환한다.

### 페이징(Paging)

_Value Object_

#### 속성

- `content`: 현재 페이지 조회 데이터
- `page`: 현재 페이지 번호
- `size`: 조회 데이터 수
- `pageSkipSize`: FastForward 페이지 이동 사이즈
- `count`: FastForward 페이지 `count` 조회 결과 (실 데이터 수)
- `hasNext`: 다음 페이지 여부
- `hasPrevious`: 이전 페이지 여부
- `isFirst`: 첫번째 페이지 여부
- `isLast`: 마지막 페이지 여부
- `fastForwardPage`: FastForward 페이지 번호
- `fastBackwardPage`: FastBackward 페이지 번호

#### 행위

- `map()`: 현재 페이지 조회 데이터의 타입을 변경한다.
- `getContent()`: 현재 페이지 조회 데이터를 변경 불가능한 컬렉션으로 래핑하여 반환한다.

### 이메일(Email)

_Value Object_

#### 속성

- `address`: 이메일 주소

### 사업자 등록 번호(BusinessLicense)

_Value Object_

#### 속성

- `value`: 사업자 등록 번호

### 휴대폰 번호(PhoneNumber)

_Value Object_

#### 속성

- `value`: 휴대폰 번호

### 위치(Position)

_Value Object_

#### 속성

- `value`: 위치 정수값

#### 행위

- `static next()`: 다음 위치값을 가진 위치를 생성한다.
- `static copy()`: 동일한 위치값을 가진 위치를 생성한다.
- `static isMoved()`: 위치값이 이동했는지 여부를 반환한다.
- `move()`: 위치를 이동한다.

### 위치 이동(PositionMove)

_Enum_

#### 상수

- `PREV`: 이전
- `NEXT`: 다음

#### 속성

- `moveCount`: 이동해야 할 위치값

#### 행위

- `move()`: 이동 후 위치값을 반환한다.

---

## 헬스 체크

### 서버 정보(ServerInfo)

_Value Object_

#### 속성

- `version`: 서버 빌드 버전
- `group`: 서버 그룹
- `artifact`: 서버 아티팩트

### 앱 버전 정보(ApkVersion)

_Entity_

_Aggregate Root_

#### 속성

- `majorVersion`: 앱 메이저 버전
- `minorVersion`: 앱 마이너 버전
- `patchVersion`: 앱 패치 버전
- `downloadUrl`: 앱 다운로드 링크

#### 행위

- `static create()`: 앱 버전 정보를 생성한다.

### ApkVersionNotFoundException

_BusinessException_

---

## 이미지

### ImageFormat

_Enum_

#### 상수

- `PNG`
- `JPG`
- `WEBP`

#### 속성

- `extension`: 이미지 포맷 파일 확장자명
- `contentType`: 이미지 포맷 파일 컨텐츠 타입
- `writer`: 이미지 포맷 파일 writer

### ImageMultipartFile

_MultipartFile_

### UnsupportedFileTypeException

_BusinessException_

### FailedConvertImageFormatException

_BusinessException_

### FailedConvertPdfToImageException

_BusinessException_

### FailedDeleteImageException

_BusinessException_

### FailedUploadImageException

_BusinessException_

---

## 서비스 도입 문의

### Contact

_Entity_

_Aggregate Root_

#### 속성

- `storeName`: 서비스를 도입할 매장 이름
- `phoneNumber`: 사장님 휴대폰 번호
- `license`: 매장 사업자 등록 번호
- `state`: [ContactState](#ContactState) 서비스 도입 문의 진행 상태

#### 행위

- `static create()`: 서비스 도입 문의를 생성한다.
- `processing()`: 서비스 도입 문의 진행 상태를 처리중 상태로 변경한다.
- `complete()`: 서비스 도입 문의 진행 상태를 처리 완료 상태로 변경한다.

### ContactState

_Enum_

#### 상수

- `PENDING`: 접수 대기
- `PROCESSING`: 처리중
- `COMPLETE`: 처리 완료

### AlreadyExistsUncompletedContactException

_BusinessException_

### ContactNotFoundException

_BusinessException_

---

## 알림

### 이메일—SimpleEmail

_Value Object_

#### 속성

- `from`: 발신 이메일
- `to`: 수신 이메일
- `subject`: 이메일 제목
- `content`: 이메일 본문

### 이메일—TemplateEmail

_Value Object_

#### 속성

- `from`: 발신 이메일
- `to`: 수신 이메일
- `subject`: 이메일 제목
- `template`: [EmailTemplate](#이메일emailtemplate) 이메일 템플릿
- `templateVariables`: 이메일 템플릿 변수 목록

#### 행위

- `addTemplateVariable()`: 이메일 템플릿 변수를 추가한다.
- `toSimpleEmail()`: [SimpleEmail](#이메일simpleemail) 도메인 객체로 변환한다.

### 이메일—EmailTemplate

_Enum_

#### 상수

- `EMAIL_AUTHENTICATION`: 이메일 인증
- `STORE_REGISTRATION_APPROVE`: 매장 등록 승인
- `STORE_REGISTRATION_REJECT`: 매장 등록 반려

#### 속성

- `templateName`: 템플릿 파일명
- `variableCount`: 템플릿 변수 개수

#### 행위

- `createContent()`: 템플릿을 사용한 이메일 본문을 생성한다.

### 알림톡—AlimTalkMessage

_Value Object_

#### 속성

- `templateCode`: 알림톡 템플릿 코드
- `to`: 알림톡 수신 휴대폰 번호
- `content`: 알림톡 본문
- `useSmsFailover`: 알림톡 발송 실패 시 SMS 사용 여부
- `buttons`: 알림톡 버튼 목록

#### 행위

- `addButton()`: 알림톡 버튼을 추가한다.

### 알림톡—AlimTalkTemplate

_Enum_

#### 상수

- `AUTHENTICATION_CODE`: 인증 번호 안내
- `WAITING_REGISTRATION`: 웨이팅 등록
- `WAITING_CUSTOMER_CALL`: 웨이팅 손님 호출
- `WAITING_CUSTOMER_CANCEL`: 웨이팅 손님 취소
- `WAITING_STORE_CANCEL`: 웨이팅 매장 취소

#### 속성

- `templateCode`: 네이버 클라욷 플랫폼에 등록된 템플릿 코드
- `templateContent`: 네이버 클라욷 플랫폼에 등록된 템플릿 본문 (정확히 일치해야함)

#### 행위

- `createContent()`: 템플릿을 사용한 알림톡 본문을 반환한다.

### 알림톡—AlimTalkButton

_Marker Interface_

### 알림톡—AlimTalkWeblinkButton

_Value Object_

_AlimTalkButton_

#### 속성

- `type`: 알림톡 버튼 타입 (WL)
- `name`: 알림톡 버튼 이름
- `linkMobile`: 모바일 웹 링크
- `linkPc`: PC 웹 링크

### 알림톡—AlimTalkButtonTemplate

_Interface_

#### 행위

- `createButton()`: 알림톡 버튼을 생성한다.

### 알림톡—AlimTalkWeblinkButtonTemplate

_Enum_

_AlimTalkButtonTemplate_

#### 상수

- `WAITING_CANCEL`: 웨이팅 취소 버튼
- `CHECK_MY_TURN`: 내 순서 확인하기 버튼
- `MENU_PREVIEW`: 메뉴 미리보기 버튼

#### 속성

- `name`: 버튼 이름
- `link`: 버튼 클릭 시 이동할 웹(앱)링크

#### 행위

- `createButton()`: 알림톡 버튼을 생성한다.

### 디스코드—DiscordEmbeds

_Value Object_

#### 속성

- `embeds`: `DiscordEmbed` 목록

### 디스코드—DiscordEmbed

_Value Object_

#### 속성

- `title`: 디스코드 임베드 제목
- `description`: 디스코드 임베드 설명
- `color`: [DiscordColor](#디스코드discordcolor) 디스코드 임베드 색상
- `fields`: 디스코드 임베드 필드 목록

#### 행위

- `addField()`: 디스코드 임베드 필드를 추가한다.

### 디스코드—DiscordField

_Value Object_

#### 속성

- `name`: 필드 이름
- `value`: 필드값

### 디스코드—DiscordColor

_Enum_

#### 상수

- `GREEN`: 초록색
- `BLUE`: 파란색
- `DARK_BLUE`: 진한 파란색
- `RED`: 빨간색

#### 속성

- `value`: 10진수 색상값

---

## SSE

### SseEvent

_Value Object_

#### 속성

- `storeId`: SSE를 발행할 매장 ID
- `category`: [SseCategory](#SseCategory) SSE 발행 주체 카테고리 (도메인 목록)
- `action`: [ServerAction](#ServerAction) 서버에서 어떤 작업을 했는지에 대한 정보 (CRUD)
- `hasData`: SSE 응답 데이터 여부
- `data`: SSE 응답 데이터

### SseCategory

_Enum_

#### 상수

- `DEVICE`: 기기 도메인
- `STORE`: 매장 도메인
- `CATEGORY`: 카테고리 도메인
- `MENU`: 메뉴 도메인
- `WAITING`: 웨이팅 도메인
- `ORDER`: 주문 도메인
- `STAFF_CALL`: 직원 호출 도메인
- `RECEIPT`: 레시피 도메인
- `POS`: POS 도메인

### ServerAction

_Enum_

#### 상수

- `GET`: 조회
- `CREATE`: 생성
- `UPDATE`: 수정
- `DELETE`: 삭제

### SseKeyType

_Enum_

#### 상수

- `EMITTER`: SSE Emitter
- `EVENT`: SSE Event

#### 행위

- `createKey()`: SSE 이미터 또는 이벤트를 저장할 때 사용할 키를 생성한다.
- `createScanKey()`: SSE 이미터 또는 이벤트를 조회할 때 사용할 스캔용 키를 생성한다.

---

## 인증

### AuthenticationAccount

_Annotation_

Spring AOP를 사용하여 웹 계층에서 로그인 여부, 권한 검증에 사용된다.

### AuthenticationDevice

_Annotation_

Spring AOP를 사용하여 웹 계층에서 기기 인증, 기기 사용 용도 검증에 사용된다.

### Auth

_Interface_

#### 행위

- `key()`: 인증 번호, 인증 성공, 인증 시도 횟수를 저장할 키값을 반환한다.
- `value()`: 인증 번호, 인증 성공, 인증 시도 횟수를 저장할 값을 반환한다.
- `expiration()`: 인증 번호, 인증 성공, 인증 시도 횟수의 유효 기간을 반환한다.

### AuthAttempt

_Auth_

#### 속성

- `purpose`: [AuthPurpose](#AuthPurpose) 인증 목적
- `phoneNumber`: [PhoneNumber](#휴대폰-번호phonenumber) 인증할 휴대폰 번호
- `expiration`: 인증 시도 횟수 유효 기간(24시간)

#### 행위

- `isExceed()`: 인증 시도 횟수 초과 여부를 반환한다.
- `key()`: 인증 시도 횟수를 저장할 때 사용하는 키값을 반환한다.
- `value()`: 사용 안함

### AuthCode

_Auth_

#### 속성

- `phoneNumber`: [PhoneNumber](#휴대폰-번호phonenumber) 인증 번호를 전송할 휴대폰 번호
- `code`: 인증 번호
- `expiration`: 인증 번호 유효 기간(5분)

#### 행위

- `verify()`: 인증 번호를 검증한다.
- `key()`: 인증 번호를 저장할 때 사용하는 키값을 반환한다.
- `value()`: 인증 번호를 반환한다.

### AuthSuccess

_Auth_

#### 속성

- `purpose`: [AuthPurpose](#AuthPurpose) 인증 목적
- `phoneNumber`: [PhoneNumber](#휴대폰-번호phonenumber) 인증 휴대폰 번호
- `expiration`: 인증 성공 유효 기간

#### 행위

- `key()`: 인증 성공을 저장할 때 사용하는 키값을 반환한다.
- `value()`: 사용 안함

### AuthPurpose

_Enum_

#### 상수

- `SIGN_UP`: 회원가입
- `CREATE_DEVICE`: 기기 생성

#### 속성

- `maxAttempt`: 최대 인증 시도 가능 횟수
- `expiration`: 인증 목적별 인증 성공 유효 기간

#### 행위

- `isExceed()`: 인증 시도 횟수 초과 여부를 반환한다.
- `getLowerCaseName()`: 상수명을 소문자로 변환하여 반환한다.

### RefreshToken

_Entity_

_Aggregate Root_

#### 속성

- `accountId`: 리프레시 토큰 소유 계정 ID
- `currentTokenId`: 현재 활성 리프레시 토큰 ID

#### 행위

- `static create()`: 리프레시 토큰을 생성한다.
- `renew()`: 리프레시 토큰을 갱신한다.

### SignInToken

_Value Object_

#### 속성

- `accessToken`: 로그인 또는 토큰 갱신 시 발급한 액세스 토큰
- `refreshToken`: 로그인 또는 토큰 갱신 시 발급한 리프레시 토큰

### JwtPayload

_Value Object_

#### 속성

- `id`: JWT의 ID
- `subject`: JWT의 SUBJECT

### AlreadyVerifiedPhoneException

_BusinessException_

### ExceedMaximumVerificationException

_BusinessException_

### ExpiredVerificationCodeException

_BusinessException_

### ExpiredVerificationEmailException

_BusinessException_

### ExpiredVerificationPhoneException

_BusinessException_

### UnmatchedVerificationCodeException

_BusinessException_

---

## 계정

### Account

_Entity_

_Aggregate Root_

#### 속성

- `email`: [Email](#이메일email) 이메일 주소
- `password`: 암호화 된 비밀번호
- `phoneNumber`: [PhoneNumber](#휴대폰-번호phonenumber) 휴대폰 번호
- `state`: [AccountState](#AccountState) 계정 상태
- `permission`: [AccountPermission](#AccountPermission) 계정 권한
- `lastSignIn`: 마지막 로그인 시간

#### 행위

- `static create()`: 계정을 생성한다.
- `isInactive()`: 계정이 비활성 상태인지 여부를 반환한다.
- `isActive()`: 계정이 활성 상태인지 여부를 반환한다.
- `hasPermission()`: 계정이 권한을 가지고 있는지 여부를 반환한다. (계층형)
- `activate()`: 비활성 상태의 계정을 활성 상태로 변경한다.
- `authorize()`: 활성 상태의 계정에 권한을 부여한다.
- `signIn()`: 계정을 로그인 처리한다.
- `update()`: 관리자 계정으로 사용자 계정 정보를 업데이트한다.

### AccountState

_Enum_

#### 상수

- `INACTIVE`: 비활성 - 이메일 인증이 완료되지 않은 상태
- `ACTIVE`: 활성 - 이메일 인증이 완료된 상태
- `DELETE`: 탈퇴 - 계정이 삭제된 상태

### AccountPermission

_Enum_

#### 상수

- `USER`: 사용자 권한 - 매장 등록 신청 가능
- `OWNER`: 사장님 권한 - 매장 등록이 완료되어 모든 기능을 사용 가능
- `ADMIN`: 관리자 권한 - 모두의 웨이터 관리자

### PasswordEncoder

_Interface_

#### 행위

- `encode()`: 평문 비밀번호를 암호화한다.
- `matches()`: 평문 비밀번호와 암호화 비밀번호가 일치하는지 검사한다.

### AccountNotFoundException

_BusinessException_

### AlreadyUseEmailException

_BusinessException_

### AlreadyUsePhoneException

_BusinessException_

### AlreadyVerifiedEmailException

_BusinessException_

### DisabledAccountException

_BusinessException_

### FailedSignInException

_BusinessException_

---

## 기기

### Device

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 기기를 생성한 매장
- `name`: 기기 이름
- `purpose`: [DevicePurpose](#DevicePurpose) 기기 사용 용도
- `tableNo`: 테이블 번호
- `state`: 기기 상태
- `paymentType`: [DevicePaymentType](#DevicePaymentType) 기기 결제 타입
- `secretKey`: 기기 시크릿 키

#### 행위

- `static createPos()`: POS 기기를 생성한다.
- `static createHall()`: 홀 관리 기기를 생성한다.
- `static createTable()`: 손님 테이블 기기를 생성한다.
- `static createWaiting()`: 웨이팅 기기를 생성한다.
- `isActive()`: 기기가 활성 상태인지 여부를 반환한다.
- `isPrepaid()`: 기기의 결제 타입이 선결제인지 여부를 반환한다.
- `hasPurpose()`: 기기의 사용 용도가 일치하는지 여부를 반환한다.
- `updatePos()`: 기기 정보 수정과 동시에 POS 기기로 변경한다.
- `updateHall()`: 기기 정보 수정과 동시에 홀 관리 기기로 변경한다.
- `updateTable()`: 기기 정보 수정과 동시에 손님 테이블 기기로 변경한다.
- `updateWaiting()`: 기기 정보 수정과 동시에 웨이팅 기기로 변경한다.
- `delete()`: 기기를 삭제한다.

### DeviceState

_Enum_

#### 상수

- `INACTIVE`: 비활성
- `ACTIVE`: 활성

### DevicePurpose

_Enum_

#### 상수

- `POS`: POS
- `HALL`: 홀 관리
- `TABLE`: 손님 테이블
- `WAITING`: 웨이팅

### DevicePaymentType

_Enum_

#### 상수

- `PREPAID`: 선결제 (손님 테이블에서 결제 후 주문)
- `POSTPAID`: 후결제 (손님 테이블에서 주문 후 POS에서 결제)

### DeviceNotFoundException

_BusinessException_

### AlreadyUseDeviceNameException

_BusinessException_

## 매장 공통

### BusinessDetail

_Value Object_

#### 속성

- `name`: 매장 상호명
- `ceoName`: 대표자명
- `address`: 매장 주소
- `landline`: 매장 유선 전화번호
- `license`: [BusinessLicense](#사업자-등록-번호businesslicense) 사업자 등록 번호
- `licenseImage`: 사업자 등록증 이미지 주소

#### 행위

- `static create()`: 매장 상세 정보를 생성한다.
- `update()`: 매장 상세 정보를 수정한다.

---

## 매장 등록

### Registration

_Entity_

_Aggregate Root_

#### 속성

- `account`: [Account](#Account) 매장 등록을 신청한 계정
- `detail`: [BusinessDetail](#BusinessDetail) 매장 상세 정보
- `status`: [RegistrationStatus](#RegistrationStatus) 매장 등록 신청 상태
- `rejectReason`: 매장 등록 신청 반려 사유

#### 행위

- `static apply()`: 매장 등록을 신청한다.
- `reapply()`: 매장 등록을 재신청한다.
- `approve()`: 관리자가 매장 등록 신청을 승인한다.
- `reject()`: 관리자가 매장 등록 신청을 반려한다.
- `isApplied()`: 매장 등록 신청 상태가 신청 상태인지 여부를 반환한다.
- `isRejected()`: 매장 등록 신청 상태가 반려 상태인지 여부를 반환한다.

### RegistrationStatus

_Enum_

#### 상수

- `APPLY`: 신청
- `REAPPLY`: 재신청
- `APPROVE`: 승인
- `REJECT`: 반려

### RegistrationNotFoundException

_BusinessException_

### AppliedRegistrationCanApproveException

_BusinessException_

### AppliedRegistrationCanRejectException

_BusinessException_

### RejectedRegistrationCanReapplyException

_BusinessException_

---

## 매장

### Store

_Entity_

_Aggregate Root_

#### 속성

- `account`: [Account](#Account) 매장 소유 계정
- `detail`: [BusinessDetail](#BusinessDetail) 매장 상세 정보
- `status`: 매장 영업 상태
- `lastOpenedAt`: 마지막 영업 시작 시간
- `lastClosedAt`: 마지막 영업 종료 시간
- `setting`: 매장 설정 정보

#### 행위

- `static create()`: 매장을 생성한다.
- `update()`: 매장 정보 및 설정 정보를 수정한다.
- `open()`: 매장 영업을 시작한다.
- `close()`: 매장 영업을 종료한다.
- `isOpen()`: 매장이 영업중인지 여부를 반환한다.
- `isClosed()`: 매장이 영업 종료했는지 여부를 반환한다.
- `hasStaffCallOption()`: 매장 설정 정보 중 찾고자 하는 직원 호출 옵션이 있는지 여부를 반환한다.

### StoreStatus

_Enum_

#### 상수

- `OPEN`: 영업중
- `CLOSE`: 영업 마감

### StoreOpen

_Annotation_

Spring AOP를 사용하여 웹 계층에서 매장이 영업중인지 여부 검증에 사용된다.

### StoreOwner

_Annotation_

Spring AOP를 사용하여 웹 계층에서 계정 소유의 매장인지 여부 검증에 사용된다.

### StoreExist

_Annotation_

Spring AOP를 사용하여 웹 계층에서 매장이 존재하는지 여부 검증에 사용된다.

### StoreNotFoundException

_BusinessException_

### AlreadyOpenedStoreException

_BusinessException_

### AlreadyClosedStoreException

_BusinessException_

### ClosedStoreException

_BusinessException_

---

## 매장 설정

### Setting

_Entity_

_Aggregate_

#### 속성

- `ksnetDeviceNo`: KSNET 단말기 번호
- `extraTableCount`: POS 여분 테이블 개수
- `printerLocation`: [PrinterLocation](#PrinterLocation) 주방 프린터 연결 위치
- `showMenuPopup`: 손님 테이블 메뉴 클릭 시 팝업 출력 여부
- `showOrderTotalPrice`: 손님 테이블 주문 내역 총 주문 금액 출력 여부
- `countryOfOrigins`: [CountryOfOrigin](#CountryOfOrigin) 음식 원산지 정보 목록
- `staffCallOptions`: [StaffCallOption](#StaffCallOption) 직원 호출 옵션 목록

#### 행위

- `update()`: 매장 설정 정보를 수정한다.
- `hasStaffCallOption()`: 매장 설정 정보 중 찾고자 하는 직원 호출 옵션이 있는지 여부를 반환한다.

### PrinterLocation

_Enum_

#### 상수

- `POS`: POS
- `HALL`: 홀 관리

### CountryOfOrigin

_Value Object_

#### 속성

- `item`: 음식 품목 ex) 소고기
- `origin`: 음식 원산지 ex) 국내산

### StaffCallOption

_Value Object_

#### 속성

- `optionName`: 직원 호출 옵션명

---

## 메뉴

### Category

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 카테고리 소유 매장
- `name`: 카테고리 이름
- `position`: [Position](#위치position) 카테고리 위치(순서)
- `menus`: [Menu](#Menu) 카테고리 하위 메뉴 목록

#### 행위

- `static create()`: 카테고리를 생성한다.
- `update()`: 카테고리를 수정한다.
- `movePosition()`: 카테고리 위치(순서)를 이동한다.
- `delete()`: 카테고리를 삭제한다.

### Menu

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 메뉴 소유 매장
- `category`: [Category](#Category) 메뉴 카테고리
- `name`: 메뉴 이름
- `description`: 메뉴 설명
- `price`: 메뉴 가격
- `spicy`: 메뉴 맵기 단계
- `state`: [MenuState](#MenuState) 메뉴 상태
- `label`: [MenuLabel](#MenuLabel) 메뉴 라벨
- `image`: 메뉴 이미지 링크
- `printEnabled`: 주방 프린터 출력해야하는지 여부
- `position`: [Position](#위치position) 메뉴 위치(순서)
- `menuOptionGroups`: [MenuOptionGroup](#MenuOptionGroup) 메뉴 옵션 그룹 목록

#### 행위

- `static create()`: 메뉴를 생성한다.
- `update()`: 메뉴 정보 및 옵션을 수정한다.
- `movePosition()`: 메뉴 위치(순서)를 이동한다.
- `canOrder()`: 메뉴가 주문이 가능한 상태인지 여부를 반환한다.
- `delete()`: 메뉴를 삭제한다.

### MenuState

_Enum_

#### 상수

- `DEFAULT`: 기본(활성) 상태
- `HIDE`: 숨김 상태
- `SOLD_OUT`: 품절 상태

### MenuLabel

_Enum_

#### 상수

- `DEFAULT`: 기본
- `NEW`: 신규
- `BEST`: 최고
- `RECOMMEND`: 추천

### MenuOptionGroup

_Entity_

_Aggregate_

#### 속성

- `Menu`: [Menu](#Menu) 메뉴 옵션 그룹 상위 메뉴
- `name`: 메뉴 옵션 그룹명
- `type`: [MenuOptionGroupType](#MenuOptionGroupType) 메뉴 옵션 그룹 타입
- `printEnabled`: 주방 프린터 출력해야하는지 여부
- `position`: [Position](#위치position) 메뉴 옵션 그룹 위치(순서)
- `menuOptionGroups`: [MenuOption](#MenuOption) 메뉴 옵션 목록

#### 행위

- `static create()`: 메뉴 옵션 그룹을 생성한다.
- `static createMenuOptionGroups()`: 메뉴 옵션 그룹 목록을 생성한다.
- `isMandatory()`: 메뉴 옵션 선택이 필수인지 여부를 반환한다.
- `getDiscountPrice()`: 메뉴 할인 옵션들의 총 금액을 반환한다.
- `getMenuOption()`: 메뉴 옵션을 찾아서 반환한다.

### MenuOptionGroupType

_Enum_

#### 상수

- `MANDATORY`: 필수
- `OPTIONAL`: 선택

### MenuOption

_Value Object_

#### 속성

- `name`: 메뉴 옵션명
- `price`: 메뉴 옵션 가격
- `position`: [Position](#위치position) 메뉴 옵션 위치(순서)

#### 행위

- `static create()`: 메뉴 옵션을 생성한다.
- `static createMenuOptions()`: 메뉴 옵션 목록을 생성한다.

### CategoryNotFoundException

_BusinessException_

### MenuNotFoundException

_BusinessException_

### MenuOptionGroupNotFoundException

_BusinessException_

### MenuOptionNotFoundException

_BusinessException_

### AlreadyUseCategoryNameException

_BusinessException_

### ExceedMaxCategoryCountException

_BusinessException_

### ExceedMaxMenuCountException

_BusinessException_

### InvalidMenuOptionDiscountPriceException

_BusinessException_

---

## 웨이팅

### Waiting

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 웨이팅 등록 매장
- `phoneNumber`: [PhoneNumber](#휴대폰-번호phonenumber) 웨이팅 고객 휴대폰 번호
- `adult`: 웨이팅 성인 인원 수
- `infant`: 웨이팅 유아 인원 수
- `number`: 웨이팅 번호
- `initWaitingTeamCount`: 웨이팅 등록 당시 매장에 등록되어 있던 웨이팅 수
- `accessKey`: 웨이팅 고객이 웨이팅 정보 조회에 사용하는 액세스 키
- `customerCall`: [CustomerCall](#CustomerCall) 웨이팅 고객 호출 정보
- `state`: [WaitingState](#WaitingState) 웨이팅 상태

#### 행위

- `static register()`: 웨이팅을 등록한다.
- `isRegistration()`: 웨이팅이 등록 상태인지 여부를 반환한다.
- `customerCall()`: 매장에서 웨이팅 고객을 호출한다. (입장 안내)
- `complete()`: 매장에서 웨이팅을 완료 처리한다.
- `cancel()`: 매장 또는 웨이팅 고객이 웨이팅을 취소한다.

### CustomerCall

_Value Object_

#### 속성

- `count`: 웨이팅 고객 호출 횟수
- `lastCallTime`: 웨이팅 고객 마지막 호출 시간

#### 행위

- `call()`: 웨이팅 고객을 호출하여 호출 횟수와 마지막 호출 시간을 갱신한다.

### WaitingState

_Enum_

#### 상수

- `REGISTRATION`: 등록 상태
- `CANCEL`: 취소 상태
- `COMPLETE`: 완료 상태

### WaitingNotFoundException

_BusinessException_

### AlreadyRegisteredWaitingException

_BusinessException_

### ExceedMaxCustomerCallException

_BusinessException_

### ExistIncompleteWaitingException

_BusinessException_

### RegistrationWaitingCanCancelException

_BusinessException_

### RegistrationWaitingCanCompleteException

_BusinessException_

### RegistrationWaitingCanCustomerCallException

_BusinessException_

---

## 주문

### Order

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 주문 매장
- `posTableActivity`: [PosTableActivity](#PosTableActivity) POS 테이블 액티비티
- `category`: [OrderCategory](#OrderCategory) 주문 카테고리
- `type`: [OrderType](#OrderType) 주문 타입
- `state`: [OrderState](#OrderState) 주문 상태
- `price`: 총 주문 금액
- `memo`: 주문 메모
- `serving`: [Serving](#Serving) 주문 서빙 정보
- `orderMenus`: [OrderMenu](#OrderMenu) 주문 메뉴 목록

#### 행위

- `static create()`: 주문을 생성한다.
- `moveTable()`: 테이블을 이동한다.
- `serving()`: 주문 또는 주문 메뉴 서빙을 완료한다.
- `cancel()`: 주문을 취소한다.
- `updateOrderMenu()`: 주문 메뉴를 수정한다.
- `update()`: 주문 메모를 수정한다.
- `isPrepaid()`: 주문이 선결제 주문인지 여부를 반환한다.
- `isOrdered()`: 주문이 주문 상태인지 여부를 반환한다.
- `isCanceled()`: 주문이 취소 상태인지 여부를 반환한다.
- `hasOrderMenu()`: 주문 메뉴가 하나 이상 있는지 여부를 반환한다.
- `getTotalOrderPrice()`: 주문의 총 주문 금액을 반환한다.
- `getFirstOrderMenuName()`: 주문의 주문 메뉴 중 첫번째 메뉴의 이름을 반환한다.
- `getOrderMenuCount()`: 주문의 주문 메뉴 개수를 반환한다.
- `getOrderMenu()`: 주문에서 주문 메뉴를 찾는다.
- `getPrintEnabledOrderMenus()`: 주방 프린터에 출력해야하는 주문 메뉴 목록을 반환한다.

### OrderCategory

_Enum_

#### 상수

- `INITIAL`: 첫 주문
- `ADDITIONAL`: 추가 주문

### OrderType

_Enum_

#### 상수

- `PREPAID`: 후결제
- `POSTPAID`: 선결제

### OrderState

_Enum_

#### 상수

- `ORDER`: 주문
- `CANCEL`: 취소

### Serving

_Value Object_

#### 속성

- `served`: 서빙 완료 여부
- `servedTime`: 서빙 완료 시간

#### 행위

- `complete()`: 서빙을 완료한다.
- `cancel()`: 서빙을 취소한다.

### OrderMenu

_Entity_

_Aggregate_

#### 속성

- `order`: [Order](#Order) 주문
- `name`: 주문 메뉴 이름
- `price`: 주문 메뉴 가격
- `quantity`: 주문 메뉴 수량
- `serving`: [Serving](#Serving) 주문 메뉴 서빙 정보
- `printEnabled`: 주문 메뉴 주방 프린터 출력해야하는지 여부
- `orderOptionGroups`: [OrderOptionGroup](#OrderOptionGroup) 주문 옵션 그룹 목록

#### 행위

- `static create()`: 주문 메뉴를 생성한다.
- `static createOrderMenus()`: 주문 메뉴 목록을 생성한다.
- `serving()`: 주문 메뉴를 서빙한다.
- `toggleServing()`: 주문 메뉴 서빙 여부에 따라 주문 메뉴 서빙 완료 또는 서빙 취소 처리한다.
- `update()`: 주문 메뉴 수량을 수정한다.
- `calculateTotalPrice()`: 주문 옵션값을 포함한 총 가격을 계산하여 반환한다.
- `getPrintEnabledOrderOptionGroups()`: 주방 프린터에 출력해야하는 주문 옵션 그룹 목록을 반환한다.

### OrderOptionGroup

_Entity_

_Aggregate_

#### 속성

- `orderMenu`: [OrderMenu](#OrderMenu) 주문 메뉴
- `name`: 주문 옵션 그룹명
- `printEnabled`: 주방 프린터에 출력해야하는지 여부
- `orderOptions`: [OrderOption](#OrderOption) 주문 옵션 목록

#### 행위

- `static create()`: 주문 옵션 그룹을 생성한다.
- `static createOrderOptionGroups()`: 주문 옵션 그룹 목록을 생성한다.
- `calculateTotalPrice()`: 주문 옵션들의 총 가격을 계산하여 반환한다.
- `getFormattedOrderOptions()`: 주문 옵션들을 `- 옵션 그룹명: 옵션명` 형식으로 포맷팅한 목록을 반환한다.

### OrderOption

_Value Object_

#### 속성

- `name`: 주문 옵션명
- `price`: 주문 옵션 가격
- `position`: [Position](#위치position) 주문 옵션 위치(순서)

#### 행위

- `static create()`: 주문 옵션을 생성한다.
- `static createOrderOptions()`: 주문 옵션 목록을 생성한다.

### OrderNotFoundException

_BusinessException_

### OrderMenuNotFoundException

_BusinessException_

### AlreadyCanceledOrderException

_BusinessException_

### AlreadyCompletedServingOrderException

_BusinessException_

### EmptyShoppingCartException

_BusinessException_

### IncludeSoldOutMenuException

_BusinessException_

### InvalidOrderMenuQuantityException

_BusinessException_

---

## 주문 결제

### OrderPayment

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 주문 결제 매장
- `posTableActivity`: [PosTableActivity](#PosTableActivity) POS 테이블 액티비티
- `method`: [OrderPaymentMethod](#OrderPaymentMethod) 주문 결제 수단
- `state`: [OrderPaymentState](#OrderPaymentState) 주문 결제 상태
- `amount`: 결제 금액
- `cancellable`: 결제 취소 가능 여부
- `approvalNo`: (카드 결제) 결제 승인 번호
- `installment`: (카드 결제) 할부 개월
- `cardNo`: (카드 결제) 카드 번호
- `issuerName`: (카드 결제) 카드 발급사명
- `purchaseName`: (카드 결제) 카드 매입사명
- `merchantNo`: (카드 결제) 카드사/포인트사 가맹점 번호
- `tradeTime`: (카드 결제) 거래일시 YYMMDDHHmmss
- `tradeUniqueNo`: (카드 결제) 거래 고유 번호
- `vat`: 부가세
- `supplyAmount`: 공급가액
- `cashReceiptNo`: (현금 결제) 현금 영수증 번호
- `cashReceiptType`: [CashReceiptType](#CashReceiptType) (현금 결제) 현금 영수증 타입

#### 행위

- `static approve()`: 주문 결제 승인을 생성한다.
- `static cancel()`: 주문 결제 취소를 생성한다.
- `moveTable()`: 테이블을 이동한다.
- `isCard()`: 주문 결제의 결제 수단이 카드 결제인지 여부를 반환한다.
- `isApproved()`: 주문 결제의 상태가 승인 상태인지 여부를 반환한다.
- `isCanceled()`: 주문 결제의 상태가 취소 상태인지 여부를 반환한다.
- `canCancel()`: 주문 결제를 취소할 수 있는지 여부를 반환한다.
- `getPaymentPrice()`: 주문 결제 금액을 반환한다.

### OrderPaymentMethod

_Enum_

#### 상수

- `CASH`: 현금
- `CARD`: 카드

### OrderPaymentState

_Enum_

#### 상수

- `APPROVE`: 승인
- `CANCEL`: 취소

### CashReceiptType

_Enum_

#### 상수

- `NONE`: 미발행
- `DEDUCTION`: 소비자 소득공제
- `PROOF`: 사업자 지출증빙

### OrderPaymentNotFoundException

_BusinessException_

### AlreadyCanceledOrderPaymentException

_BusinessException_

---

## 직원 호출

### StaffCall

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 직원 호출 매장
- `tableNo`: 테이블 번호
- `name`: 직원 호출 옵션명
- `state`: [StaffCallState](#StaffCallState) 직원 호출 상태
- `completeTime`: 직원 호출 완료 시간

#### 행위

- `static call()`: 직원을 호출한다.
- `complete()`: 직원 호출을 완료한다.

### StaffCallState

_Enum_

#### 상수

- `INCOMPLETE`: 미완료
- `COMPLETE`: 완료

### StaffCallNotFoundException

_BusinessException_

### StaffCallOptionNotFoundException

_BusinessException_

### AlreadyCompletedStaffCallException

_BusinessException_

---

## 레시피

손님 테이블 또는 POS에서 주문 시 주방 프린터에 출력해야 할 메뉴 정보

### Receipt

_Value Object_

#### 속성

- `memo`: 주방 메모
- `printNo`: 주방 프린트 출력 번호
- `receiptMenus`: [ReceiptMenu](#ReceiptMenu) 주방 프린터 출력 메뉴 목록

#### 행위

- `static of()`: 주문 또는 주문 목록으로 레시피를 생성한다.
- `static diff()`: 수정 전 주문과 수정 후 주문의 차이로 레시피를 생성한다.
- `static cancel()`: 취소 주문 레시피를 생성한다.

### ReceiptMenu

_Value Object_

#### 속성

- `name`: 메뉴 이름
- `quantity`: 메뉴 수량
- `options`: 주문 옵션 목록

#### 행위

- `static from()`: 레시피 메뉴를 생성한다.
- `static of()`: 레시피 메뉴를 생성한다.
- `static cancel()`: 취소 레시피 메뉴를 생성한다.

---

## POS

### PosTable

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 매장
- `tableNo`: 테이블 번호
- `active`: POS 테이블 활성 여부
- `activities`: [PosTableActivity](#PosTableActivity) POS 테이블 액티비티 목록

#### 행위

- `static create()`: POS 테이블을 생성한다.
- `merge()`: 활성 POS 테이블 액티비티를 다른 활성 액티비티와 병합한다.
- `move()`: 활성 POS 테이블 액티비티를 다른 테이블로 이동한다.
- `discount()`: 활성 POS 테이블 액티비티를 통해 테이블 할인을 적용한다.
- `completeActiveActivity()`: 활성 POS 테이블 액티비티를 완료 처리한다.
- `cancelOrder()`: 활성 POS 테이블 액티비티의 주문을 취소한다.
- `updateOrder()`: 활성 POS 테이블 액티비티의 주문을 수정한다.
- `resendReceipt()`: 활성 POS 테이블 액티비티의 주문들을 주방 프린터로 재전송한다.
- `hasActiveActivity()`: 활성 POS 테이블 액티비티가 있는지 여부를 반환한다.
- `hasOrder()`: 활성 POS 테이블 액티비티에 주문 상태의 주문이 있는지 여부를 반환한다.
- `getTablePaymentType()`: 활성 POS 테이블 액티비티의 결제 타입을 반환한다.
- `getActivityCreatedAt()`: 활성 POS 테이블 액티비티의 생성일을 반환한다.
- `getFirstOrderMenuName()`: 활성 POS 테이블 액티비티의 첫번째 주문 메뉴 이름을 반환한다.
- `getOrderMenuCount()`: 활성 POS 테이블 액티비티의 주문 메뉴 개수를 반환한다.
- `getTableTotalOrderPrice()`: 활성 POS 테이블 액티비티의 총 주문 금액을 반환한다.
- `getDiscountPrice()`: 활성 POS 테이블 액티비티의 할인 금액을 반환한다.
- `getActiveActivity()`: 활성 POS 테이블 액티비티를 반환한다.
- `getActiveActivityOrThrow()`: 활성 POS 테이블 액티비티를 반환하고, 찾지 못하면 예외를 던진다.
- `getOrderedOrders()`: 활성 POS 테이블 액티비티에서 주문 상태의 주문 목록을 반환한다.

### PosTableActivity

_Entity_

_Aggregate Root_

#### 속성

- `store`: [Store](#Store) 매장
- `posTable`: [PosTable](#PosTable) POS 테이블
- `tableNo`: 테이블 번호
- `discount`: 할인 금액
- `active`: 활성 여부
- `orders`: [Order](#Order) 액티비티의 주문 목록
- `payments`: [OrderPayment](#OrderPayment) 액티비티의 주문 결제 목록

#### 행위

- `static create()`: POS 테이블 액티비티를 생성한다.
- `addOrder()`: 액티비티에 주문을 추가한다.
- `addPayment()`: 액티비티에 주문 결제를 추가한다.
- `merge()`: 다른 액티비티의 주문, 주문 결제를 현재 액티비티에 병합한다.
- `moveTable()`: 테이블을 이동한다.
- `discount()`: 할인 금액을 수정한다.
- `complete()`: 액티비티를 완료 처리한다.
- `cancelOrder()`: 액티비티의 주문을 취소한다.
- `updateOrder()`: 액티비티의 주문을 수정한다.
- `hasOrder()`: 액티비티에 주문이 있는지 여부를 반환한다.
- `hasOrderedOrder()`: 액티비티에 주문 상태의 주문이 있는지 여부를 반환한다.
- `isPostpaidTable()`: 액티비티의 결제 타입이 후결제인지 여부를 반환한다.
- `getRemainingPaymentPrice()`: 잔여 결제 금액을 반환한다. (할인 미포함)
- `getRemainingPaymentPriceWithDiscount()`: 잔여 결제 금액을 반환한다. (할인 포함)
- `getTotalOrderPrice()`: 액티비티의 총 주문 금액을 반환한다.
- `getTotalPaymentPrice()`: 액티비티의 총 주문 결제 금액을 반환한다.
- `getTablePaymentType()`: 액티비티의 주문들을 통해 액티비티의 결제 타입을 반환한다.
- `getOrder()`: 액티비티에서 주문을 찾는다.
- `getOrderedOrder()`: 액티비티에서 주문 상태의 주문을 찾는다.
- `getOrderedOrders()`: 액티비티에서 주문 상태의 주문 목록을 반환한다.

### PosTableNotFoundException

_BusinessException_

### PosTableActivityNotFoundException

_BusinessException_

### PosTableActiveActivityNotFoundException

_BusinessException_

### ExistIncompletePosTableActivityException

_BusinessException_

### HasRemainingPaymentException

_BusinessException_

---
